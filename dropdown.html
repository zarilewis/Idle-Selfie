<div class="idle-settings">
  <div class="inline-drawer">
    <div class="inline-drawer-toggle inline-drawer-header" title="Settings for the Idle Selfie feature. Automatically triggers in-character selfie-style messages after inactivity.">
      <b>Idle Selfie</b>
      <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
    </div>

    <div class="inline-drawer-content">

      <!-- Enable / Count -->
      <div class="idle_block flex-container">
        <input id="idle_enabled" type="checkbox" title="Toggle to enable or disable the Idle Selfie feature." />
        <label for="idle_enabled">Enabled</label>
      </div>

      <div class="idle_block flex-container">
        <input id="idle_repeats" class="text_pole widthUnset" type="number" min="0" max="100000" step="1" title="How many times Idle Selfie can trigger before stopping (0 = infinite)." />
        <label for="idle_repeats">Idle Selfie Count</label>
      </div>

      <!-- Timing -->
      <div class="idle_block flex-container" style="display: none;">
        <input id="idle_timer_min" class="text_pole widthUnset" type="number" min="0" max="600000" step="1" title="Minimum idle time in seconds before a selfie-style message is triggered (used when Randomize Time is on)." />
        <label for="idle_timer_min">Idle Timer Minimum (seconds)</label>
      </div>

      <div class="idle_block flex-container">
        <input id="idle_timer" class="text_pole widthUnset" type="number" min="0" max="600000" step="1" title="Idle time in seconds before a selfie-style message is triggered." />
        <label for="idle_timer">Idle Timer (seconds)</label>
      </div>

      <!-- Prompts -->
      <div class="idle_block flex-container">
        <label for="idle_prompts">Selfie Flavor Prompts</label>
        <textarea id="idle_prompts" class="text_pole textarea_compact" rows="6" title="Flavor/emote lines used as inspiration for the in-character selfie message (one per line)."></textarea>
      </div>

      <!-- Classic Idle toggles -->
      <div class="idle_block flex-container">
        <input id="idle_use_continuation" type="checkbox" title="Use the 'Continue' function instead of the selfie-style behavior. (Turn OFF for Idle Selfie to work as designed.)" />
        <label for="idle_use_continuation">Use Continuation (classic Idle)</label>
      </div>

      <div class="idle_block flex-container">
        <input type="checkbox" id="idle_use_regenerate" title="Use the 'Regenerate' function instead of the selfie-style behavior. (Turn OFF for Idle Selfie.)">
        <label for="idle_use_regenerate">Use Regenerate</label>
      </div>

      <div class="idle_block flex-container">
        <input type="checkbox" id="idle_use_swipe" title="Use the 'Swipe' function instead of the selfie-style behavior. (Turn OFF for Idle Selfie.)">
        <label for="idle_use_swipe">Use Regenerate with history (Swipe)</label>
      </div>

      <div class="idle_block flex-container">
        <input id="idle_use_impersonation" type="checkbox" title="Use the 'Impersonate' function instead of the selfie-style behavior. (Turn OFF for Idle Selfie.)" />
        <label for="idle_use_impersonation">Use Impersonation</label>
      </div>

      <div class="idle_block mutually_exclusive_warning">
        (Continuation, Regenerate, Swipe, and Impersonation are mutually exclusive)
      </div>

      <!-- Randomize / Include -->
      <div class="idle_block flex-container">
        <input id="idle_random_time" type="checkbox" title="Randomize the idle time between a minimum and maximum value." />
        <label for="idle_random_time">Randomize Time</label>
      </div>

      <div class="idle_block flex-container">
        <input id="idle_include_prompt" type="checkbox" title="If enabled, the selfie system prompt is included as visible text. For in-world behavior, leave this OFF." />
        <label for="idle_include_prompt">Include Selfie Prompt in Context</label>
      </div>

      <!-- Send As -->
      <div class="idle_block flex-container">
        <label for="idle_sendAs">Send As</label>
        <select id="idle_sendAs" class="text_pole" title="How the Idle Selfie instruction is sent; for selfie behavior, 'System' is recommended.">
          <option value="user">User</option>
          <option value="char">Character</option>
          <option value="sys">System</option>
          <option value="raw">Raw</option>
        </select>
      </div>

      <!-- Gemini Model -->
      <div class="idle_block flex-container">
        <label for="idle_selfie_model">Gemini Image Model</label>
        <select id="idle_selfie_model" class="text_pole" title="Choose the Gemini model used to generate images.">
          <option value="gemini-3.0-pro-image-preview">gemini-3.0-pro-image-preview</option>
        </select>
      </div>

      <!-- Aspect Ratio -->
      <div class="idle_block flex-container">
        <label for="idle_selfie_aspect">Aspect Ratio</label>
        <select id="idle_selfie_aspect" class="text_pole" title="Aspect ratio for generated images.">
          <option value="4:3" selected>4:3</option>
          <option value="1:1">1:1</option>
          <option value="16:9">16:9</option>
          <option value="9:16">9:16</option>
        </select>
      </div>

      <!-- API key -->
      <div class="idle_block flex-container">
        <label for="idle_selfie_api_key">Gemini API Key</label>
        <input id="idle_selfie_api_key" class="text_pole widthUnset" type="password" placeholder="Enter API key" title="Your Gemini API key (stored locally only)." />
      </div>

      <!-- Reference Image (optional) -->
      <div class="idle_block flex-container">
        <label for="idle_selfie_reference">Reference Image URL</label>
        <input id="idle_selfie_reference" class="text_pole widthUnset" type="text" placeholder="Optional: link to base character image" title="Optional: a reference portrait for consistent generation." />
      </div>

      <hr class="sysHR" />
    </div>
  </div>
</div>
